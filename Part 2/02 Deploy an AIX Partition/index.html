
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Red Hat Ansible Automation Platform Level 3 for Sales and Technical Sales">
      
      
        <meta name="author" content="Christopher Bienko (cdbienko@us.ibm.com)">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.4.1">
    
    
      
        <title>Deploy an AIX Partition using PowerVC - Red Hat Ansible Automation Platform Level 3 for Sales and Technical Sales</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.69437709.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Red Hat Ansible Automation Platform Level 3 for Sales and Technical Sales" class="md-header__button md-logo" aria-label="Red Hat Ansible Automation Platform Level 3 for Sales and Technical Sales" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Red Hat Ansible Automation Platform Level 3 for Sales and Technical Sales
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Deploy an AIX Partition using PowerVC
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Red Hat Ansible Automation Platform Level 3 for Sales and Technical Sales" class="md-nav__button md-logo" aria-label="Red Hat Ansible Automation Platform Level 3 for Sales and Technical Sales" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Red Hat Ansible Automation Platform Level 3 for Sales and Technical Sales
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Part 1 - Prerequisites and Provisioning
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Part 1 - Prerequisites and Provisioning" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Part 1 - Prerequisites and Provisioning
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Part%201/01%20Getting%20Started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Part 2 - Deploying a Virtual Machine via Ansible Automation Platform
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Part 2 - Deploying a Virtual Machine via Ansible Automation Platform" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Part 2 - Deploying a Virtual Machine via Ansible Automation Platform
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01%20Deploy%20a%20VM/" class="md-nav__link">
        Deploy a Virtual Machine
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Deploy an AIX Partition using PowerVC
      </a>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Part 3 - Deploy a WebSphere Application Server using Ansible Automation Platform
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Part 3 - Deploy a WebSphere Application Server using Ansible Automation Platform" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Part 3 - Deploy a WebSphere Application Server using Ansible Automation Platform
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Part%203/01%20Laying%20the%20Groundwork/" class="md-nav__link">
        Laying the Groundwork
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Part%203/02%20Creating%20Roles%20for%20WAS/" class="md-nav__link">
        Creating Roles for WAS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Part%203/03%20Staging%20and%20Execution/" class="md-nav__link">
        Creating the Staging Directory for WAS, Copying Source Files, and Executing the Installer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Part%203/04%20Creating%20a%20Template/" class="md-nav__link">
        Creation of a Template
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Part%203/05%20Launching%20WAS/" class="md-nav__link">
        Installation of WAS, Creation of a Profile, and Launching the Software
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


  <h1>Deploy an AIX Partition using PowerVC</h1>

<p><img alt="type:video" src="./_videos/IBM Power Systems Virtual Server Level 3 - Introduction.mp4" /></p>
<div class="admonition tip">
<p class="admonition-title">Ways to watch</p>
<p>In addition to the embedded video, IBMers and Business Partners can also <a href="https://ibm.seismic.com/Link/Content/DCGdHJ7DMdqHD8cV7Wp8f4Rg9Bgd" target="_blank">download the recording from Seismic</a>.</p>
</div>
<p>The deployment of an AIX operating system partition on to the PowerVC infrastructure will be automated entirely via the Ansible control (master) node. Ansible will make use of the inventory we've defined, a Playbook that we will modify to paint the broad strokes for what automation is to be performed, and built-in Modules that are part of Ansible's engine to carry out those instructions. Ansible OpenStack Modules— downloaded in the previous step —will allow Ansible to create an LPAR (logical partition) on the PowerVC infrastructure where the AIX operating system can reside.</p>
<p>Begin modification of the OpenStack configuration file (located within your home directory on the Ansible control node) using the following instruction:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>vi clouds.yaml
</code></pre></div></p>
<p>If you cloned the Git repository earlier, a template has already been crafted for you; otherwise, you will need to recreate it using the sample code below.</p>
<p>Regardless of the route you take, you will need to modify the template to the specifications of your ITZ credentials and environment. The value <strong>idXXXXXXXX</strong> must be replaced with the <em>username/ID</em> that was recorded from the Project Kit page.</p>
<p>The same holds true for other variables or fields that have been bolded below in the sample script: if it is highlighted in red text within the screenshot, you must modify the clouds.yaml script for those fields to your own specifications and then save the changes before moving on.</p>
<div class="admonition note">
<p class="admonition-title">Tips for the VI editor</p>
<p>Remember: <strong>ESC</strong> and then <strong>:x</strong> followed by the <strong>Return</strong> key to save your work and exit the VI editor.</p>
</div>
<p>The <em>clouds.yaml</em> template should look like the following screenshot. Modify as necessary to match the specifications of your unique ITZ environment. Update the userID, password, project name (<em>ansiblewas</em>), and the host address (this address should match the PowerVC GUI address from the Project Kit).</p>
<p><img alt="" src="../_attachments/part2_figure1.png" /></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>clouds:
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>  idXXXXXXXX:
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    auth:
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>      auth_url: https://10.3.44.65:5000/v3/
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>      domain_name: Default
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>      username: idXXXXXXXX
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>      password: Provided_password
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>      project_name: ansiblewas
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>    verify: false
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Be careful about indentation</p>
<p>Ansible is very particular about indentation and nesting rules. In this example, every indentation level is denoted by two whitespaces. Also be sure to preserve the empty newline at the end of this example (the empty final line must be present within your YAML manifest.)</p>
</div>
<p>After modifying and saving the <em>clouds.yaml</em> manifest file, we need to define the Playbook which Ansible will execute against. Modify (or create) the Playbook for generating a virtual machine via the following:
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>vi mkvm.yaml
</code></pre></div></p>
<p>As before, adjust the template as necessary: you will need to substitute your own values for:</p>
<ul>
<li>
<p>user</p>
</li>
<li>
<p>gather_facts</p>
</li>
<li>
<p>cloud</p>
</li>
<li>
<p>public_key_file</p>
</li>
<li>
<p>cloud</p>
</li>
<li>
<p>name</p>
</li>
<li>
<p>key_name</p>
</li>
<li>
<p>net-name</p>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Keys are automatically generated ahead of time</p>
<p>The <strong>ansible_key_idXXXXXXXX</strong> and the <strong>public_key_file</strong> were created automatically for you by the IBM Technology Zone as part of your environment reservation. You do not need to generate or locate these files yourself — simply modify the <em>idXXXXXXXX</em> value to match your <em>userID</em>.</p>
</div>
<p><img alt="" src="../_attachments/part2_figure2.png" /></p>
<p>The code template is available below for ease of copying and modifying your own variant:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>---
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>- hosts: localhost
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>  gather_facts: false
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>  vars:
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>     ansible_connection: local
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>  tasks:
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>  - name: adding ssh key to powervc
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    os_keypair:
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>      cloud: idXXXXXXXX
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>      state: present
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>      name: ansible_key_idXXXXXXXX
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>      public_key_file: /home/idXXXXXXXX/.ssh/id_rsa.pub
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>  - name: Create a new VM instance
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>    os_server:
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>      cloud: idXXXXXXXX
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>      timeout: 900
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>      state: present
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>      name: vmidXXXXXXXX
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>      image: AIX721_7022_300G_DEMO
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>      flavor: was
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>      key_name: ansible_key_idXXXXXXXX
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>      nics:
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>        - net-name: VLAN344
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>    register: vm
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>  - name: Showing newly assigned IP address
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a>    debug:
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a>      msg: the IP address is &quot;{{ vm.server.public_v4 }}&quot;
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a>  - name: Waits for SSH port 22 to open
<a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a>    wait_for:
<a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a>      host: &quot;{{ vm.server.public_v4 }}&quot;
<a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a>      delay: 5
<a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a>      port: 22
<a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a>      sleep: 10
<a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a>      timeout: 900
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Line 11</p>
<p>For the '<em>name</em>' field (line 11) you must include both <em>vm</em> + <em>idXXXXXXXXX</em> ( do not forget to prefix with <em>vm</em>) in your manifest. The '<em>name</em>' variable will appear as BLANK when working from the Git repository clone — both sellers and technical sellers <strong>must complete</strong> this variable definition regardless of whether they are working from the Git repository clone or not.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Line 16</p>
<p>The '<em>net-name</em>' field (line 16) must be set equal to <strong>VLAN344</strong>, if it hasn't already been by default.</p>
</div>
<p>Save and exit the <em>mkvm.yaml</em> Playbook once satisfied. Let's take a moment, before moving on, to parse out what some of these fields and modifications have done.</p>
<ul>
<li>
<p><strong>os_keypair</strong>: Allows Ansible to upload your account's public SSH key to PowerVC, which will be used at deployment time to ensure that we won't need to use password authentication in the future.</p>
</li>
<li>
<p><strong>os_server</strong>: Creates the virtual machine on the cloud name defined within the clouds.yaml manifest file.</p>
</li>
<li>
<p><strong>debug</strong>: Will print to screen the IP address assigned to PowerVC once deployed. Record this information for later.</p>
</li>
<li>
<p><strong>wait_for</strong>: Ensures that the virtual machine has had time to boot up and the SSH port to be opened before re-enabling prompts from the terminal.</p>
</li>
</ul>
<p>Before we get started with execution of the Playbook, open a Web browser on your local machine and navigate to the PowerVC GUI URL (in the first row of the Project Kit table), supplying your <em>userID</em> and <em>password</em> from the same table when prompted to log in. This will load a dashboard overview of your PowerVC infrastructure and all that is transpiring under the covers. Keep this tab open, as we can use it to track the progress of our virtual machine deployment over time.</p>
<p><img alt="" src="../_attachments/part2_figure3.png" /></p>
<p>You may encounter a <em>"Connection is not private"</em> warning when attempting to access the website. Click <strong>"visit this website"</strong> at the bottom of the message (for Safari browsers), or ignore the warning if prompted to do so, and continue to the PowerVC GUI page. The dashboard will look similar to the one captured in the screenshot below.</p>
<p><img alt="" src="../_attachments/part2_figure4.png" /></p>
<p>Time to execute the Playbook! Return to your Terminal console and submit the following command:
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>ansible-playbook mkvm.yaml -v
</code></pre></div></p>
<p>If everything goes smoothly, a virtual machine will be deployed to PowerVC in a matter of minutes. If you encounter errors or things don't go as planned — don't panic. Ansible, as warned about previously, is quite particular about things like indentation. A misplaced whitespace or a slipped finger on the keyboard can create a typo that will throw the script into disarray (after all, Ansible will try to execute your instructions exactly as you have written.) Go back into the scripts mentioned previously and verify that everything is correct and that all necessary substitutions have been made, then try executing the <strong>ansible-playbook</strong> instruction (above) a second time.</p>
<p>While execution of the Playbook is underway, return to the PowerVC dashboard and click the VM List button from the taskbar on the left. Previously this tab would have displayed as empty. As the execution of the Playbook gets underway, a new virtual machine will be listed with the status of "<em>Building</em>;" once the virtual machine has been deployed, the status will be adjusted to "<em>Active</em>."</p>
<p><img alt="" src="../_attachments/part2_figure5.png" /></p>
<p>Once the build task has completed and the status is set to "<em>Active</em>," the IP field of the table will be populated with the virtual machine's address. Record this information for later.</p>
<p><img alt="" src="../_attachments/part2_figure6.png" /></p>
<p>Return to the Terminal console where you have SSH'd into the Ansible control node. Take note of the verbose logs that were returned for every stage of the Playbook execution. Within these logs you'll find details on various aspects of the virtual machine deployment, such as the Image ID (e.g. <em>AIX721-7022-300G-DEMO</em>) for the AIX partition. If you return to the PowerVC dashboard and drill down into the Image List tab, you can locate the matching Image ID and inspect it for additional details.</p>
<p>While you're on the dashboard, try exploring the Network ID (e.g. <em>VL344</em>) as well. Here you will find a table summarizing all of the networks defined with your PowerVC instance, including their VLAN IDs, Type, the number of VMs using that particular network connection, subnet masks, gateway IDs, and DNS server(s).</p>
<p>Other areas of the PowerVC dashboard can also be explored, should you wish. When satisfied, we'll proceed with modifying the <strong>hosts</strong> file parameters on the Ansible control node using the newly-generated virtual machine IP address. The <strong>hosts</strong> file provides a list (an inventory, if you will) of the AIX partitions (the newly-generated virtual machine) where Ansible is to execute Playbook tasks.</p>
<p>Edit the <strong>hosts</strong> file using the following statement:
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>vi hosts
</code></pre></div></p>
<p>As before, use the template already cloned from Git (or craft your own) and substitute the placeholder IP address with the one associated with the newly-deployed AIX virtual machine.</p>
<p><img alt="" src="../_attachments/part2_figure7.png" /></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>was:
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>  hosts:
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    10.3.44.XX:
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>      remote_tmp: /tmp/
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">What is <em>was</em>?</p>
<p>The <em>was</em> variable is in reference to the Compute Template used by our PowerVC virtual machine deployment; it was defined ahead of time for the ITZ environment specifically to meet the resource requirements for WebSphere Application Server (<em>was</em>). You can drill down into the Compute Template tab from the PowerVC dashboard if you wish to inspect further details about it.</p>
</div>
<p>In the following section, we'll set the stage for a full deployment of WebSphere Application Server atop of the AIX VM that is now running on PowerVC infrastructure.</p>




              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../01%20Deploy%20a%20VM/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Deploy a Virtual Machine" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Deploy a Virtual Machine
            </div>
          </div>
        </a>
      
      
        
        <a href="../../Part%203/01%20Laying%20the%20Groundwork/" class="md-footer__link md-footer__link--next" aria-label="Next: Laying the Groundwork" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Laying the Groundwork
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 IBM
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.9c69f0bc.min.js"></script>
      
    
  </body>
</html>