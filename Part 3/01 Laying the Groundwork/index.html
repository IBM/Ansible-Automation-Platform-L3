
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Red Hat Ansible Automation Platform Level 3 for Sales and Technical Sales">
      
      
        <meta name="author" content="Christopher Bienko (cdbienko@us.ibm.com)">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.4.1">
    
    
      
        <title>Laying the Groundwork - Red Hat Ansible Automation Platform Level 3 for Sales and Technical Sales</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.69437709.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Red Hat Ansible Automation Platform Level 3 for Sales and Technical Sales" class="md-header__button md-logo" aria-label="Red Hat Ansible Automation Platform Level 3 for Sales and Technical Sales" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Red Hat Ansible Automation Platform Level 3 for Sales and Technical Sales
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Laying the Groundwork
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Red Hat Ansible Automation Platform Level 3 for Sales and Technical Sales" class="md-nav__button md-logo" aria-label="Red Hat Ansible Automation Platform Level 3 for Sales and Technical Sales" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Red Hat Ansible Automation Platform Level 3 for Sales and Technical Sales
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Part 1 - Prerequisites and Provisioning
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Part 1 - Prerequisites and Provisioning" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Part 1 - Prerequisites and Provisioning
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Part%201/01%20Getting%20Started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Part 2 - Deploy a Virtual Machine via Ansible Automation Platform
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Part 2 - Deploy a Virtual Machine via Ansible Automation Platform" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Part 2 - Deploy a Virtual Machine via Ansible Automation Platform
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Part%202/01%20Deploy%20a%20VM/" class="md-nav__link">
        Deploy a Virtual Machine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Part%202/02%20Deploy%20an%20AIX%20Partition/" class="md-nav__link">
        Deploy an AIX Partition on PowerVC using Ansible
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Part 3 - Deploy a WebSphere Application Server instance via Ansible Automation Platform
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Part 3 - Deploy a WebSphere Application Server instance via Ansible Automation Platform" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Part 3 - Deploy a WebSphere Application Server instance via Ansible Automation Platform
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Laying the Groundwork
      </a>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02%20Creating%20Roles%20for%20WAS/" class="md-nav__link">
        Creating Roles for WAS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../03%20Staging%20and%20Execution/" class="md-nav__link">
        Creating the Staging Directory for WAS, Copying Source Files, and Executing the Installer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04%20Creating%20a%20Template/" class="md-nav__link">
        Creation of a Template
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05%20Launching%20WAS/" class="md-nav__link">
        Installation of WAS, Creation of a Profile, and Launching the Software
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Part 4 - Level 3 Accreditation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Part 4 - Level 3 Accreditation" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Part 4 - Level 3 Accreditation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Part%204/01%20Business%20Partner%20Accreditation/" class="md-nav__link">
        Business Partner Accreditation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Part%204/02%20IBMer%20Accreditation/" class="md-nav__link">
        IBM Seller and Technical Seller Accreditation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<p><div class="video-container"><iframe src="../_videos/Part%203a%20-%20Laying%20the%20Groundwork%20-%20Red%20Hat%20Ansible%20Automation%20Platform%20Level%203%20for%20Sales%20and%20Technical%20Sales.mp4" style="position: relative; width: 100%; height: 22.172vw" frameborder="0" allowfullscreen></iframe></div></p>
<div class="admonition tip">
<p class="admonition-title">WAYS TO WATCH</p>
<p>In addition to the embedded video, IBMers and Business Partners can also <a href="https://ibm.seismic.com/Link/Content/DCffVRBC9CP6m8WP8TCg8X76CJqd" target="_blank">download the recording from Seismic</a>.</p>
</div>
<p>Preparations are complete and the groundwork has been set for a fully-automated installation and deployment of <strong>WebSphere Application Server (WAS)</strong> via AAP. At this stage, you have already used AAP to deploy a virtual machine with an AIX partition atop of PowerVC infrastructure. Additional configurations will need to be made to that partition to prepare it for hosting a WAS deployment within it. These types of configuration changes are precisely the type of operational work that can be easily automated by AAP, and a prime example of how businesses today are offloading administrative burdens through automation.</p>
<p>In the following steps, you will instruct AAP to perform the following operations:</p>
<ul>
<li>
<p>Change <em>root</em> user characteristics using the <strong>power_aix Ansible modules</strong>, downloaded via Ansible Galaxy.</p>
</li>
<li>
<p>Change the <em>/tmp</em> filesystem size to 6GB</p>
</li>
<li>
<p>Change the <em>/var</em> filesystem size to 2GB</p>
</li>
<li>
<p>Change the <em>/opt</em> filesystem size to 4GB</p>
</li>
<li>
<p>Change the <em>/usr</em> filesystem size to 6GB</p>
</li>
<li>
<p>Install additional software and libraries such as zip, unzip, and gnu tar</p>
</li>
<li>
<p>Generate a WebSphere installation response file</p>
</li>
<li>
<p>Upload WAS binaries</p>
</li>
<li>
<p>Install WAS</p>
</li>
<li>
<p>Create a WAS profile</p>
</li>
<li>
<p>Start WAS</p>
</li>
</ul>
<p>To proceed, you will first need to download an <em>IBM Power Systems collection for AIX on Power</em> via the <strong>Ansible Galaxy</strong> repository. Roles are frequently published on the Ansible Galaxy community site (<a href="https://galaxy.ansible.com" target="_blank">https://galaxy.ansible.com</a>). Via communities such as Galaxy, thousands of Roles are available for AAP users to use within their own Playbooks.</p>
<p>To install these on the AAP control node, invoke the following command using your SSH console:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>ansible-galaxy collection install ibm.power_aix
</code></pre></div></p>
<p>Installation of the drivers should take only a moment to complete.</p>
<h1 id="_1"></h1>
<h1 id="another-handy-feature-of-aap-is-its-ability-to-simplify-how-code-is-shared-amongst-teams-which-traditionally-becomes-challenging-and-cumbersome-at-scale-in-the-absence-of-automation">Another handy feature of AAP is its ability to simplify how code is shared amongst teams, which traditionally becomes challenging and cumbersome at scale in the absence of automation.</h1>
<p>AAP employs a feature known as "<strong>Roles</strong>" which allow a developer to define a common set of configuration steps that can then be re-used repeatedly across multiple environments. Instead of having to coordinate across teams and share duplicate instructions with different groups, the developer can take the "write once, run anywhere" approach of defining an automation job a single time and then making repeated use of that code (consistently) across multiple environments.</p>
<p>In our case, we will define an Ansible Role comprised of a set of tasks needed to configure a host (our AIX partition) for a service (WebSphere Application Server). Roles, like many other aspects of AAP, are defined using YAML files with a predefined directory structure.</p>
<p>Roles provide a way for you to make it easier to reuse AAP code generically. You can package, in a standardized directory structure, all the tasks, variables, files, templates, and other resources needed to provision infrastructure or deploy applications. Administrators may copy that role from project to project simply by replicating the directory. They can then simply <em>call</em> (invoke) that role from a Play to execute it. Roles convey a number of other benefits to developers and administrators:</p>
<ul>
<li>
<p>Roles help to group content, allowing easy sharing of code with others</p>
</li>
<li>
<p>Roles can be written that define the essential elements of a system type: web server, database server, Git repository, or other purpose</p>
</li>
<li>
<p>Roles make larger projects more manageable</p>
</li>
<li>
<p>Roles can be developed in parallel by different administrators</p>
</li>
</ul>
<p>The directory structure of a Role contains directories such as defaults, vars, tasks, files, templates, meta, and handlers — these are all "expected" directories (we can make use of all of them or only a subset) that Ansible Roles must be patterned against. Each directory must contain a <strong>main.yml</strong> file which provides the relevant content needed by AAP to execute a Playbook. Let's examine the purpose of each directory type, in turn:</p>
<ul>
<li>
<p><strong>defaults</strong>: Contains default variables for the Role; variables by default have the lowest priority, so they are easy to override.</p>
</li>
<li>
<p><strong>vars</strong>: Contains variables for the Role; variables in <em>vars</em> have a higher priority than <em>default</em> variables.</p>
</li>
<li>
<p><strong>tasks</strong>: Contains the main list of steps to be executed by the Role.</p>
</li>
<li>
<p><strong>files</strong>: Contains files which must be copied over to the remote host.</p>
</li>
<li>
<p><strong>templates</strong>: Contains file templates that support modifications from the Role; in our lab work, we will use the <a href="https://jinja.palletsprojects.com/en/3.1.x/" target="_blank"><em>Jinja2 templating language</em></a> for creating templates.</p>
</li>
<li>
<p><strong>meta</strong>: Contains metadata for the Role, including the author, supported platforms, and dependencies.</p>
</li>
<li>
<p><strong>handlers</strong>: Contains handlers which can be invoked by "notify" directives; these are associated with the service.</p>
</li>
</ul>
<p>AAP supports <strong>variables</strong> that can be used to store values that can then be reused throughout files in an AAP project. Variables provide a convenient way to manage dynamic values for a given environment in your AAP project. This can simplify the creation and maintenance of a project, as well as mitigate the risk of errors introduced through typos or mislabeled items in your code. Variables might include:</p>
<ul>
<li>
<p>Users to create</p>
</li>
<li>
<p>Packages to install</p>
</li>
<li>
<p>Services to restart</p>
</li>
<li>
<p>Files to remove</p>
</li>
<li>
<p>Archives to retrieve from the internet</p>
</li>
</ul>
<p>We have yet to define the directory structures needed by Ansible Roles for our project, so let's tackle that step next. The directory structure you are to define in the steps ahead will look similar to the following diagram, with two distinct Roles names (<em>aix</em> and <em>was</em>), and subdirectories nestled within those parents.</p>
<p><img alt="" src="../_attachments/part3_figure1.png" /></p>
<p>Execute the following instructions via your SSH console, line by line, to create the directory structure needed for the Roles.</p>
<div class="admonition warning">
<p class="admonition-title">NAVIGATE TO THE CORRECT DIRECTORY <em>FIRST</em></p>
<p>Make sure you are sitting in the <em>/ansiblewas</em> directory before creating the following subdirectories!</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>cd $HOME/ansiblewas
</code></pre></div>
</div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>mkdir -p roles/aix/tasks
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>mkdir -p roles/aix/defaults
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>mkdir -p roles/aix/templates
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>mkdir -p roles/was/tasks
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>mkdir -p roles/was/defaults
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>mkdir -p roles/was/templates
</code></pre></div>
<p>With AIX installed on the PowerVC LPAR (logical partition), you next need to modify root user settings associated with the virtual machine to increase the size of the filesystems available to it, as well as install additional dependencies and drivers needed for the environment. You will do so with modifications to the Roles associated with "<em>aix</em>" via the <strong>main.yml</strong> manifest file. Modify (or view) the YAML file using the following command:
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>vi roles/aix/tasks/main.yml
</code></pre></div></p>
<p>As before, you can either view the contents of the manifest (if you cloned the Github repository earlier) or craft a new one from scratch using the following template. No modifications to the template will be needed at this time. When satisfied, press <code>ESC</code> following by <code>:x</code> and <code>Return</code> to save your changes and exit the VI editor.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>---
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>- name: modifying root capabilities
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>  ibm.power_aix.user:
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    state: modify
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    name: root
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    attributes:
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>      fsize: -1
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>      cpu: -1
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>      data: -1
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>      stack: -1
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>      core: -1
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>      rss: -1
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>      nofiles: -1
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>      fsize_hard: -1
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>- name: Changes /tmp to 6G size
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>  aix_filesystem:
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>    filesystem: /tmp
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>    size: 6G
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>    state: present
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>- name: Changes /var to 2G size
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>  aix_filesystem:
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>    filesystem: /var
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>    size: 2G
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>    state: present
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>
<a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a>- name: Changes /opt to 4G size
<a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a>  aix_filesystem:
<a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a>    filesystem: /opt
<a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a>    size: 4G
<a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a>    state: present
<a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a>
<a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a>- name: Changes /usr to 6G
<a id="__codelineno-4-35" name="__codelineno-4-35" href="#__codelineno-4-35"></a>  aix_filesystem:
<a id="__codelineno-4-36" name="__codelineno-4-36" href="#__codelineno-4-36"></a>    filesystem: /usr
<a id="__codelineno-4-37" name="__codelineno-4-37" href="#__codelineno-4-37"></a>    size: 6G
<a id="__codelineno-4-38" name="__codelineno-4-38" href="#__codelineno-4-38"></a>    state: present
<a id="__codelineno-4-39" name="__codelineno-4-39" href="#__codelineno-4-39"></a>
<a id="__codelineno-4-40" name="__codelineno-4-40" href="#__codelineno-4-40"></a>- name: installing zip, unzip, GNUtar using yum
<a id="__codelineno-4-41" name="__codelineno-4-41" href="#__codelineno-4-41"></a>  yum:
<a id="__codelineno-4-42" name="__codelineno-4-42" href="#__codelineno-4-42"></a>    name: unzip, zip, tar-1.32-1
<a id="__codelineno-4-43" name="__codelineno-4-43" href="#__codelineno-4-43"></a>    state: latest
<a id="__codelineno-4-44" name="__codelineno-4-44" href="#__codelineno-4-44"></a>
<a id="__codelineno-4-45" name="__codelineno-4-45" href="#__codelineno-4-45"></a>- name: Creating staging directory
<a id="__codelineno-4-46" name="__codelineno-4-46" href="#__codelineno-4-46"></a>  file:
<a id="__codelineno-4-47" name="__codelineno-4-47" href="#__codelineno-4-47"></a>    path: /tmp/im
<a id="__codelineno-4-48" name="__codelineno-4-48" href="#__codelineno-4-48"></a>    state: directory
</code></pre></div>
<p>You are now prepared to craft the Playbook that Ansible will use to automate the workflow just defined for the <em>aix</em> Role. Use the following command to edit (or create) the <em>was</em> Playbook for WebSphere Application Server:
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>vi was.yml
</code></pre></div></p>
<p>As before, you can either view the contents of the manifest (if you cloned the Github repository earlier) or craft a new one from scratch using the following template. If you are working from the cloned template, you may have noticed that the last line of the YAML file (<code>#- role: was</code>) has been commented out — leave this unchanged for now, as you will be returning to it shortly. For now we are only concerned with the successful execution of the jobs associated with the <em>aix</em> Role. The template for <strong>was.yml</strong> is as follows:</p>
<p><img alt="" src="../_attachments/part3_figure2.png" /></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>---
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>- hosts: was
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>  gather_facts: true
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>  user: root
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>  collections:
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>    - ibm.power_aix
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>  roles:
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>    - role: aix
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>    #- role: was
</code></pre></div>
<p>Ansible <strong>facts</strong> are variables that are automatically discovered by Ansible on a managed host. Facts contain host-specific information that can be used just like regular variables in plays, conditionals, loops, or any other statement that depends on a value collected from a managed host. Facts are a convenient way to retrieve the state of a managed host and to determine what action to take based on that state. Some of the facts gathered for a managed host might include:</p>
<ul>
<li>
<p>The host name</p>
</li>
<li>
<p>The kernel version</p>
</li>
<li>
<p>The network interfaces</p>
</li>
<li>
<p>The IP addresses</p>
</li>
<li>
<p>The version of the operating system</p>
</li>
<li>
<p>Various environment variables</p>
</li>
<li>
<p>The number of CPUs</p>
</li>
<li>
<p>The available amount of free memory</p>
</li>
<li>
<p>The available amount of free disk space</p>
</li>
</ul>
<p>When satisfied, press <code>ESC</code> and then <code>:x</code> and <code>Return</code> to save and exit the file.</p>
<p>Time to test the Playbook and Roles defined so far. Use the following command to execute the Playbook:
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>ansible-playbook was.yml -v
</code></pre></div></p>
<p>After execution, the Playbook should report back with a summary of jobs successfully completed ("<em>ok</em>"), changes made to the environment, jobs that have failed, and so on.</p>
<p><img alt="" src="../_attachments/part3_figure3.png" /></p>
<p>If no jobs failed to execute, you are ready to proceed with the lab instructions; otherwise, return to the Roles definition and the Playbook YAML files to ensure that there are no scripting errors.</p>




              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../../Part%202/02%20Deploy%20an%20AIX%20Partition/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Deploy an AIX Partition on PowerVC using Ansible" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Deploy an AIX Partition on PowerVC using Ansible
            </div>
          </div>
        </a>
      
      
        
        <a href="../02%20Creating%20Roles%20for%20WAS/" class="md-footer__link md-footer__link--next" aria-label="Next: Creating Roles for WAS" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Creating Roles for WAS
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 IBM
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.9c69f0bc.min.js"></script>
      
    
  </body>
</html>